import Link from 'next/link'

# Challenges
- <Link href="#highly-optimized">Highly Optimized(rev)</Link>
- <Link href="#poof">Poof(forens)</Link>


<h2 id="highly-optimized">Highly Optimized</h2>
*Solved with Sadra*
### Challenge Info
![uoftctf](/ctfs/uoftctf2025/highlyoptimizeddesc.png)

[challenge](https://play.uoftctf.org/challenges#Highly%20Optimized-79)

[highly-optimized](https://play.uoftctf.org/files/67f5c1c387af01cb54c126d11128d31f/highly-optimized?token=eyJ1c2VyX2lkIjozNDcsInRlYW1faWQiOjEyNSwiZmlsZV9pZCI6NzAzfQ.Z4Y7jw.KnoFNwBC-nAm4kUFnwY2VzW9dZA)
## Recon
![uoftctf](/ctfs/uoftctf2025/initialrun.png)
Running the challenge results in an infinite wait. We need to see what is happening with a debugger.

<video width="800" height="500" controls>
  <source src="/ctfs/uoftctf2025/initialgdb.mp4" type="video/mp4"/>
</video>

We notice that the program is consistenly jumping back to the same address point **0x55555555555100**
![sameaddr](/ctfs/uoftctf2025/sameaddr.webp)
When it jumps back to that codeblock, it performs a cmp of an address space [rbp + rax*8] with 6 and then does a notrack jmp to the address at rax
![sameaddr](/ctfs/uoftctf2025/firstblock.png)
## Radare2 Disassembly
![r2disass](/ctfs/uoftctf2025/r2disass.png)
So, there appears to be a switch statement for cases 0-6. after each case it jumps back to **0x55555555555100**. **rax** is the one being switched-on. From what we can tell, the value that RAX takes is an address relative to an initial address stored at **rbp**

Lets dump that segment of memory. You can do this by:
1. `set height 0`
2. `set logging on`
3. `x /2000s 0x200000000`
4. `quit`

![gdbdump](/ctfs/uoftctf2025/gdbdump.png)
[view the full dump](/ctfs/uoftctf2025/gdb.txt)

Do you see the numbers 0,2,3,5? these correspond to the cases in the switch statement. If you keep reading the dump you willa also find 0x06 saved in a memory region.

Now, we know that rax points to these switch codes that are stored in the memory region, we need to understand what each swich code does. We can read the disassembly, but I think it would be easier to read a decompiled form instead.


<h2 id="poof">Poof</h2>